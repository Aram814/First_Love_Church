<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Women's Fellowship Bulletin Board</title>
  
  <!-- PERFORMANCE IMPROVEMENT: Added preconnect links for faster resource loading -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- FONT STYLES (Keep in head for fast rendering) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    /* Simple date/time input styling for consistency */
    input[type="date"], input[type="time"] {
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        background-color: white; /* Ensure consistent background */
    }
    /* Dark mode adjustments for date/time inputs */
    .dark input[type="date"], .dark input[type="time"] {
        background-color: #4a4a4a; /* Match textarea in dark mode */
        color: white;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- PERFORMANCE IMPROVEMENT: ALL library scripts moved to the end of the body with 'defer' -->
  <!-- This prevents the scripts from blocking initial page rendering. -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <!-- NOTE: The script type is now standard JavaScript (no Babel). -->
  <script type="text/javascript">
    const { useState, useEffect, createContext, useContext, createElement: e, Fragment } = React;
    // WCAG IMPROVEMENT: Imported createPortal for rendering modals outside the root element
    const { createPortal } = ReactDOM;
    const { createClient } = supabase;

    // Define the colors and styles
    const tailwindColors = {
      'bg-color': '#f5f2ed',
      'card-bg-light': '#e9e2d0',
      'card-bg-dark': '#3a2f2f',
      'text-color': '#2b2b2b',
      'primary-color': '#caa72d',
      'secondary-color': '#b83b3b',
      'footer-color': '#045f5f',
      'button-bg': '#b83b3b',
      'button-hover': '#922a2a',
      'shadow': 'rgba(0,0,0,0.1)',
      'prayer-color': '#fbc02d',
      'provision-color': '#d9c9b6',
      'event-color': '#e0a399',
      'cleanup-color': '#caa79d',
      'update-color': '#045f5f',
    };

    // --- Contexts for Accessibility and UI State ---
    const FontSizeContext = createContext();
    const ThemeContext = createContext();

    // Supabase client initialization
    const supabaseUrl = 'https://btercxzikklbkjpltoey.supabase.co';
    // FIX: Confirmed the Anon Key is correctly set. If error persists, check RLS policies in Supabase.
    const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ0ZXJjeHppa2tsYmtqcGx0b2V5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwMDU5NjksImV4cCI6MjA3MTU4MTk2OX0.o0iUcb89y0TaN2-ze0cEFxljCt-tsZmbrZDl8NnEGfc';
    
    // Create Supabase instance only if the configuration is valid
    const isSupabaseConfigValid = supabaseUrl !== 'YOUR_SUPABASE_URL' && supabaseAnonKey !== 'YOUR_SUPABASE_ANON_KEY';
    const supabaseInstance = isSupabaseConfigValid ? createClient(supabaseUrl, supabaseAnonKey) : null;

    // DEBUG: Added console log to verify the configuration being used
    if (isSupabaseConfigValid) {
        console.log("Supabase Client initialized successfully.");
        // We log the URL but only the last few characters of the key to confirm it's loaded.
        console.log(`Supabase URL: ${supabaseUrl}`);
        console.log(`Supabase Key snippet (last 10 chars): ...${supabaseAnonKey.slice(-10)}`);
    } else {
        console.error("Supabase Client failed to initialize: Invalid configuration placeholders.");
    }
    
    // --- Utility Component for Confirmation Modal (Converted from JSX) ---
    function ConfirmDeleteModal({ onConfirm, onCancel }) {
      const { isDarkMode } = useContext(ThemeContext);
      const bgColor = isDarkMode ? tailwindColors['card-bg-dark'] : tailwindColors['card-bg-light'];
      const textColor = isDarkMode ? 'white' : tailwindColors['text-color'];
      
      // WCAG: Close on Escape key and set initial focus
      useEffect(() => {
          const handleKeyDown = (event) => {
              if (event.key === 'Escape') {
                  onCancel();
              }
          };
          document.addEventListener('keydown', handleKeyDown);
          
          // Set focus to the first focusable element (Cancel button)
          const firstFocusable = document.querySelector('[role="dialog"] button');
          if (firstFocusable) {
              firstFocusable.focus();
          }

          return () => {
              document.removeEventListener('keydown', handleKeyDown);
          };
      }, [onCancel]);

      const modalContent = e('div', { 
          // WCAG: aria-modal and role attributes for screen readers
          role: "dialog",
          "aria-modal": "true",
          className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" 
          },
        e('div', {
          className: "w-full max-w-sm p-6 rounded-lg shadow-xl",
          style: { backgroundColor: bgColor, color: textColor },
        },
          e('h4', { className: "text-lg font-bold mb-4" }, "Are you sure?"),
          e('p', { className: "mb-6" }, "This post will be permanently deleted. This action cannot be undone."),
          e('div', { className: "flex justify-end space-x-4" },
            e('button', {
              onClick: onCancel,
              className: "px-4 py-2 rounded-lg font-semibold transition-transform duration-200 hover:scale-105",
              style: { backgroundColor: '#ccc', color: tailwindColors['text-color'] },
            }, "Cancel"),
            e('button', {
              onClick: onConfirm,
              className: "px-4 py-2 rounded-lg font-semibold transition-transform duration-200 hover:scale-105",
              style: { backgroundColor: tailwindColors['secondary-color'], color: 'white' },
            }, "Delete")
          )
        )
      );

      // WCAG: Use createPortal to ensure modal is outside the main content flow
      return createPortal(modalContent, document.body);
    }
    
    // --- Comment Form Component (Converted from JSX) ---
    function CommentForm({ postId, isAuthReady, onCancel }) {
      const [content, setContent] = useState('');
      const [name, setName] = useState('');
      const [isLoading, setIsLoading] = useState(false);
      const [errorMessage, setErrorMessage] = useState('');
      const [successMessage, setSuccessMessage] = useState('');
      const { isDarkMode } = useContext(ThemeContext);

      const handleCommentSubmit = async (evt) => {
        evt.preventDefault();
        setIsLoading(true);
        setErrorMessage('');

        if (!isAuthReady) {
          setErrorMessage('Please wait for the app to connect before commenting.');
          setIsLoading(false);
          return;
        }

        if (!content.trim()) {
          setErrorMessage('Please write something for your comment.');
          setIsLoading(false);
          return;
        }

        try {
          const { error } = await supabaseInstance
            .from('comments')
            .insert({
              content: content.trim(),
              name: name.trim() || 'Anonymous',
              post_id: postId,
              timestamp: new Date().toISOString(),
            });
          if (error) throw error;
          setSuccessMessage('Comment submitted!');
          setContent('');
          setName('');
          setTimeout(() => {
            setSuccessMessage('');
            onCancel();
          }, 1500);
        } catch (error) {
          console.error("Error adding comment:", error);
          setErrorMessage("Failed to submit comment. Please try again.");
        } finally {
          setIsLoading(false);
        }
      };
      
      const inputStyle = {
          backgroundColor: isDarkMode ? '#4a4a4a' : 'white',
          color: isDarkMode ? 'white' : tailwindColors['text-color'],
          borderColor: isDarkMode ? 'gray-600' : 'gray-300',
          outlineColor: tailwindColors['primary-color'],
      };

      return e('form', { onSubmit: handleCommentSubmit, className: "space-y-2" },
        e('textarea', {
          value: content,
          onChange: (evt) => setContent(evt.target.value),
          rows: "2",
          className: "w-full p-2 rounded-lg border focus:ring focus:ring-opacity50",
          placeholder: "Add a comment...",
          style: inputStyle,
          required: true,
        }),
        e('input', {
          type: "text",
          value: name,
          onChange: (evt) => setName(evt.target.value),
          className: "w-full p-2 rounded-lg border focus:ring focus:ring-opacity50",
          placeholder: "Your Name (Optional)",
          style: inputStyle,
        }),
        errorMessage && e('p', { className: "text-red-500 text-sm" }, errorMessage),
        successMessage && e('p', { className: "text-green-500 text-sm" }, successMessage),
        e('div', { className: "flex space-x-2" },
          e('button', {
            type: "button",
            onClick: onCancel,
            className: "flex-1 p-2 rounded-lg font-semibold transition-transform duration-200 hover:scale-105",
            style: { backgroundColor: '#ccc', color: tailwindColors['text-color'] },
          }, "Cancel"),
          e('button', {
            type: "submit",
            className: "flex-1 p-2 rounded-lg font-semibold transition-transform duration-200 hover:scale-105",
            style: { backgroundColor: tailwindColors['button-bg'], color: 'white' },
            disabled: isLoading,
          }, isLoading ? 'Posting...' : 'Post Comment')
        )
      );
    }
    
    // --- Edit Post Form Component (Converted from JSX) ---
    function EditPostForm({ post, setIsEditing }) {
      const [content, setContent] = useState(post.content);
      const [name, setName] = useState(post.name || '');
      const [postType, setPostType] = useState(post.type || 'Update');
      const [eventDate, setEventDate] = useState(post.event_date || '');
      const [eventTime, setEventTime] = useState(post.event_time || '');
      const [isLoading, setIsLoading] = useState(false);
      const [errorMessage, setErrorMessage] = useState('');
      const [successMessage, setSuccessMessage] = useState('');
      const { isDarkMode } = useContext(ThemeContext);

      const handleEditSubmit = async (evt) => {
        evt.preventDefault();
        setIsLoading(true);
        setErrorMessage('');

        if (!content.trim()) {
          setErrorMessage('Post content cannot be empty.');
          setIsLoading(false);
          return;
        }

        if (postType === 'Event' && (!eventDate || !eventTime)) {
          setErrorMessage('Event posts require a date and time.');
          setIsLoading(false);
          return;
        }

        // NEW: Validation for Clean Up Crew
        if (postType === 'Clean Up Crew') {
            if (!eventDate) {
                setErrorMessage('Clean Up Crew posts require an available date.');
                setIsLoading(false);
                return;
            }
            if (!name.trim()) {
                setErrorMessage('Please provide your name for the Clean Up Crew post.');
                setIsLoading(false);
                return;
            }
        }
        // END NEW VALIDATION

        try {
          const { error } = await supabaseInstance
            .from('posts')
            .update({
              content: content.trim(),
              name: name.trim() || 'Anonymous',
              type: postType,
              event_date: (postType === 'Event' || postType === 'Clean Up Crew') ? eventDate : null,
              event_time: postType === 'Event' ? eventTime : null, // Clean Up Crew time is optional
              timestamp: new Date().toISOString(),
            })
            .eq('id', post.id);

          if (error) throw error;
          setSuccessMessage('Post updated successfully!');
          setTimeout(() => {
            setIsEditing(false);
          }, 1500);
        } catch (error) {
          console.error("Error updating post:", error);
          setErrorMessage("Failed to update post. Please try again.");
        } finally {
          setIsLoading(false);
        }
      };
      
      const inputStyle = {
          backgroundColor: isDarkMode ? '#4a4a4a' : 'white',
          color: isDarkMode ? 'white' : tailwindColors['text-color'],
          borderColor: isDarkMode ? 'gray-600' : 'gray-300',
          outlineColor: tailwindColors['primary-color'],
      };

      const typeOptions = ['Update', 'Prayer Request', 'Provisions Needed', 'Clean Up Crew', 'Event'];

      return e('div', {
          className: "p-6 rounded-lg shadow-md transition-all duration-300 relative",
          style: {
            backgroundColor: isDarkMode ? tailwindColors['card-bg-dark'] : tailwindColors['card-bg-light'],
            color: isDarkMode ? 'white' : tailwindColors['text-color'],
            border: `2px solid ${tailwindColors['primary-color']}`,
          }
        },
        e('h3', { className: "text-xl font-semibold mb-4 text-center" }, "Edit Post"),
        e('form', { onSubmit: handleEditSubmit },
          e('div', { className: "mb-4" },
            e('label', { className: "block text-sm font-medium mb-1", htmlFor: "editContent" }, "Post Content"),
            e('textarea', {
              id: "editContent",
              value: content,
              onChange: (evt) => setContent(evt.target.value),
              rows: "4",
              className: "w-full p-2 rounded-lg border focus:ring focus:ring-opacity50",
              style: inputStyle,
              required: true,
            })
          ),
          e('div', { className: "mb-4" },
            e('label', { className: "block text-sm font-medium mb-1" }, "Post Type"),
            e('div', { className: "flex flex-wrap gap-2" },
              typeOptions.map((type) => e('label', { key: type, className: "inline-flex items-center cursor-pointer" },
                e('input', {
                  type: "radio",
                  name: "editPostType",
                  value: type,
                  checked: postType === type,
                  onChange: (evt) => setPostType(evt.target.value),
                  className: "form-radio",
                  style: { color: tailwindColors['primary-color'] },
                }),
                e('span', { className: "ml-1 text-sm" }, type)
              ))
            )
          ),
          
          // MODIFIED: Conditional rendering for Date/Time fields
          (postType === 'Event' || postType === 'Clean Up Crew') && e(Fragment, null,
            e('div', { className: "mb-4" },
              e('label', { className: "block text-sm font-medium mb-1", htmlFor: "editEventDate" }, postType === 'Clean Up Crew' ? "Available Date (Required)" : "Event Date"),
              e('input', {
                id: "editEventDate",
                type: "date",
                value: eventDate,
                onChange: (evt) => setEventDate(evt.target.value),
                className: "w-full p-2 rounded-lg border focus:ring focus:ring-opacity50",
                style: inputStyle,
                required: true, // Now required for both Event and Clean Up Crew
              })
            ),
            e('div', { className: "mb-4" },
              e('label', { className: "block text-sm font-medium mb-1", htmlFor: "editEventTime" }, postType === 'Clean Up Crew' ? "Available Time (Optional)" : "Event Time"),
              e('input', {
                id: "editEventTime",
                type: "time",
                value: eventTime,
                onChange: (evt) => setEventTime(evt.target.value),
                className: "w-full p-2 rounded-lg border focus:ring focus:ring-opacity50",
                style: inputStyle,
                required: postType === 'Event', // Only required for Event
              })
            )
          ),

          e('div', { className: "mb-4" },
            e('label', { className: "block text-sm font-medium mb-1", htmlFor: "editName" }, 
              postType === 'Clean Up Crew' ? "Your Name (Required)" : "Your Name (Optional)" // MODIFIED LABEL
            ),
            e('input', {
              id: "editName",
              type: "text",
              value: name,
              onChange: (evt) => setName(evt.target.value),
              className: "w-full p-2 rounded-lg border focus:ring focus:ring-opacity50",
              placeholder: "Your Name",
              style: inputStyle,
              required: postType === 'Clean Up Crew', // ADDED required attribute
            })
          ),
          errorMessage && e('p', { className: "text-red-500 text-sm mb-4" }, errorMessage),
          successMessage && e('p', { className: "text-green-500 text-sm mb-4" }, successMessage),
          e('div', { className: "flex justify-end space-x-4" },
            e('button', {
              type: "button",
              onClick: () => setIsEditing(false),
              className: "px-4 py-2 rounded-lg font-semibold transition-transform duration-200 hover:scale-105",
              style: { backgroundColor: '#ccc', color: tailwindColors['text-color'] },
            }, "Cancel"),
            e('button', {
              type: "submit",
              className: "px-4 py-2 rounded-lg font-semibold transition-transform duration-200 hover:scale-105",
              style: { backgroundColor: tailwindColors['button-bg'], color: 'white' },
              disabled: isLoading,
            }, isLoading ? 'Updating...' : 'Save Changes')
          )
        )
      );
    }

    // --- Post Submission Modal Component (Converted from JSX) ---
    function PostModal({ setIsModalOpen, isAuthReady, localUserId }) {
      const [content, setContent] = useState('');
      const [name, setName] = useState('');
      const [postType, setPostType] = useState('Update');
      const [eventDate, setEventDate] = useState('');
      const [eventTime, setEventTime] = useState('');
      const [isLoading, setIsLoading] = useState(false);
      const [errorMessage, setErrorMessage] = useState('');
      const [successMessage, setSuccessMessage] = useState('');
      const { isDarkMode } = useContext(ThemeContext);
      
      // WCAG: Close on Escape key and set initial focus
      useEffect(() => {
          const handleKeyDown = (event) => {
              if (event.key === 'Escape') {
                  setIsModalOpen(false);
              }
          };
          document.addEventListener('keydown', handleKeyDown);
          
          // Set focus to the first input field
          const firstInput = document.getElementById('postContent');
          if (firstInput) {
              firstInput.focus();
          }

          return () => {
              document.removeEventListener('keydown', handleKeyDown);
          };
      }, [setIsModalOpen]);


      const handlePostSubmit = async (evt) => {
        evt.preventDefault();
        setIsLoading(true);
        setErrorMessage('');

        if (!isAuthReady) {
          setErrorMessage('Please wait for the app to connect before posting.');
          setIsLoading(false);
          return;
        }

        if (!content.trim()) {
          setErrorMessage('Please write something for your post.');
          setIsLoading(false);
          return;
        }

        // Existing validation for Event
        if (postType === 'Event' && (!eventDate || !eventTime)) {
          setErrorMessage('Event posts require a date and time.');
          setIsLoading(false);
          return;
        }

        // NEW: Validation for Clean Up Crew
        if (postType === 'Clean Up Crew') {
            if (!eventDate) {
                setErrorMessage('Clean Up Crew posts require an available date.');
                setIsLoading(false);
                return;
            }
            if (!name.trim()) {
                setErrorMessage('Please provide your name for the Clean Up Crew post.');
                setIsLoading(false);
                return;
            }
        }
        // END NEW VALIDATION

        try {
          const { error } = await supabaseInstance
            .from('posts')
            .insert({
              content: content.trim(),
              name: name.trim() || 'Anonymous',
              type: postType,
              timestamp: new Date().toISOString(),
              // Update how date/time fields are saved to cover Clean Up Crew
              event_date: (postType === 'Event' || postType === 'Clean Up Crew') ? eventDate : null,
              event_time: postType === 'Event' ? eventTime : null, // Clean Up Crew time is optional
              user_id: localUserId,
              likes: 0,
              likedBy: []
            });
          if (error) throw error;
          setSuccessMessage('Your post has been submitted!');
          setContent('');
          setName('');
          setPostType('Update');
          setEventDate('');
          setEventTime('');
          setTimeout(() => {
            setIsModalOpen(false);
          }, 1500);
        } catch (error) {
          console.error("Error adding post:", error);
          setErrorMessage("Failed to submit post. Please try again.");
        } finally {
          setIsLoading(false);
        }
      };

      const inputStyle = {
        backgroundColor: isDarkMode ? '#4a4a4a' : 'white',
        color: isDarkMode ? 'white' : tailwindColors['text-color'],
        borderColor: isDarkMode ? 'gray-600' : 'gray-300',
        outlineColor: tailwindColors['primary-color'],
      };

      const typeOptions = ['Update', 'Prayer Request', 'Provisions Needed', 'Clean Up Crew', 'Event'];

      const modalContent = e('div', {
          // WCAG: aria-modal and role attributes for screen readers
          role: "dialog",
          "aria-modal": "true",
          className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",
          style: { zIndex: 1000 }
        },
        e('div', {
          className: "w-full max-w-lg p-6 rounded-xl shadow-2xl relative transition-all duration-300",
          style: {
            backgroundColor: isDarkMode ? tailwindColors['card-bg-dark'] : tailwindColors['card-bg-light'],
            color: isDarkMode ? 'white' : tailwindColors['text-color'],
          }
        },
          e('button', {
            onClick: () => setIsModalOpen(false),
            className: "absolute top-4 right-4 text-gray-500 hover:text-gray-700",
            title: "Close Post Dialog" // Added title for accessibility
          }, "×"),
          e('h3', { className: "text-2xl font-semibold mb-4 text-center" }, "Create a New Post"),
          e('form', { onSubmit: handlePostSubmit },
            e('div', { className: "mb-4" },
              e('label', { className: "block text-sm font-medium mb-1", htmlFor: "postContent" }, "Your Post"),
              e('textarea', {
                id: "postContent",
                value: content,
                onChange: (evt) => setContent(evt.target.value),
                rows: "4",
                className: "w-full p-2 rounded-lg border focus:ring focus:ring-opacity50",
                style: inputStyle,
                required: true,
              })
            ),
            e('div', { className: "mb-4" },
              e('label', { className: "block text-sm font-medium mb-1" }, "Post Type"),
              e('div', { className: "flex flex-wrap gap-2" },
                typeOptions.map((type) => e('label', { key: type, className: "inline-flex items-center cursor-pointer" },
                  e('input', {
                    type: "radio",
                    name: "postType",
                    value: type,
                    checked: postType === type,
                    onChange: (evt) => {
                      setPostType(evt.target.value);
                      // Clear date/time if switching away from post types that require them
                      if (evt.target.value !== 'Event' && evt.target.value !== 'Clean Up Crew') {
                        setEventDate('');
                        setEventTime('');
                      }
                    },
                    className: "form-radio",
                    style: { color: tailwindColors['primary-color'] },
                  }),
                  e('span', { className: "ml-1 text-sm" }, type)
                ))
              )
            ),
            
            // MODIFIED: Conditional rendering for Date/Time fields
            (postType === 'Event' || postType === 'Clean Up Crew') && e(Fragment, null,
              e('div', { className: "mb-4" },
                e('label', { className: "block text-sm font-medium mb-1", htmlFor: "eventDate" }, postType === 'Clean Up Crew' ? "Available Date (Required)" : "Event Date"),
                e('input', {
                  id: "eventDate",
                  type: "date",
                  value: eventDate,
                  onChange: (evt) => setEventDate(evt.target.value),
                  className: "w-full p-2 rounded-lg border focus:ring focus:ring-opacity50",
                  style: inputStyle,
                  required: true, // Now required for both Event and Clean Up Crew
                })
              ),
              e('div', { className: "mb-4" },
                e('label', { className: "block text-sm font-medium mb-1", htmlFor: "eventTime" }, postType === 'Clean Up Crew' ? "Available Time (Optional)" : "Event Time"),
                e('input', {
                  id: "eventTime",
                  type: "time",
                  value: eventTime,
                  onChange: (evt) => setEventTime(evt.target.value),
                  className: "w-full p-2 rounded-lg border focus:ring focus:ring-opacity50",
                  style: inputStyle,
                  required: postType === 'Event', // Only required for Event
                })
              )
            ),

            e('div', { className: "mb-4" },
              e('label', { className: "block text-sm font-medium mb-1", htmlFor: "postName" }, 
                postType === 'Clean Up Crew' ? "Your Name (Required)" : "Your Name (Optional)" // MODIFIED LABEL
              ),
              e('input', {
                id: "postName",
                type: "text",
                value: name,
                onChange: (evt) => setName(evt.target.value),
                className: "w-full p-2 rounded-lg border focus:ring focus:ring-opacity50",
                placeholder: "Your Name",
                style: inputStyle,
                required: postType === 'Clean Up Crew', // ADDED required attribute
              })
            ),
            errorMessage && e('p', { className: "text-red-500 text-sm mb-4" }, errorMessage),
            successMessage && e('p', { className: "text-green-500 text-sm mb-4" }, successMessage),
            e('div', { className: "flex justify-end space-x-4" },
              e('button', {
                type: "button",
                onClick: () => setIsModalOpen(false),
                className: "px-4 py-2 rounded-lg font-semibold transition-transform duration-200 hover:scale-105",
                style: { backgroundColor: '#ccc', color: tailwindColors['text-color'] }
              }, "Cancel"),
              e('button', {
                type: "submit",
                className: "px-4 py-2 rounded-lg font-semibold transition-transform duration-200 hover:scale-105",
                style: { backgroundColor: tailwindColors['button-bg'], color: 'white' },
                disabled: isLoading,
              }, isLoading ? 'Submitting...' : 'Submit Post')
            )
          )
        )
      );
      
      // WCAG: Use createPortal to ensure modal is outside the main content flow
      return createPortal(modalContent, document.body);
    }

    // --- Post Card Component (Converted from JSX) ---
    function PostCard({ post, localUserId, isAuthReady }) {
      const { fontSizeMultiplier } = useContext(FontSizeContext);
      const { isDarkMode } = useContext(ThemeContext);
      const [showComments, setShowComments] = useState(false);
      const [showCommentForm, setShowCommentForm] = useState(false);
      const [comments, setComments] = useState([]);
      const [isEditing, setIsEditing] = useState(false);
      const [showDeleteModal, setShowDeleteModal] = useState(false);

      // Live listener for comments on this specific post
      useEffect(() => {
        if (isAuthReady && isSupabaseConfigValid && post.id) {
          const fetchComments = async () => {
            const { data, error } = await supabaseInstance
              .from('comments')
              .select('*')
              .eq('post_id', post.id)
              .order('timestamp');
            if (error) {
              console.error("Error fetching comments:", error);
            } else {
              setComments(data);
            }
          };

          const channel = supabaseInstance.channel(`comments-${post.id}`)
            .on('postgres_changes', { event: '*', schema: 'public', table: 'comments', filter: `post_id=eq.${post.id}` }, payload => {
              fetchComments();
            })
            .subscribe();

          fetchComments();

          return () => {
            supabaseInstance.removeChannel(channel);
          };
        }
      }, [isAuthReady, post.id]); // Removed isSupabaseConfigValid as it's static

      // Function to handle liking a post
      const handleLike = async () => {
        if (!localUserId || !isSupabaseConfigValid) {
          console.error("User not authenticated or Supabase not configured to like post.");
          return;
        }

        try {
          const { data: postData, error: fetchError } = await supabaseInstance
            .from('posts')
            .select('likes, likedBy')
            .eq('id', post.id)
            .single();

          if (fetchError) throw fetchError;

          const likedBy = postData.likedBy || [];
          const hasLiked = likedBy.includes(localUserId);

          let newLikes = postData.likes;
          let newLikedBy = [...likedBy];

          if (hasLiked) {
            newLikes = Math.max(0, newLikes - 1);
            newLikedBy = newLikedBy.filter(id => id !== localUserId);
          } else {
            newLikes = newLikes + 1;
            newLikedBy.push(localUserId);
          }

          const { error: updateError } = await supabaseInstance
            .from('posts')
            .update({
              likes: newLikes,
              likedBy: newLikedBy
            })
            .eq('id', post.id);

          if (updateError) throw updateError;
        } catch (error) {
          console.error("Error liking/unliking post:", error);
        }
      };

      const handleDelete = async () => {
        try {
          const { error: commentError } = await supabaseInstance
            .from('comments')
            .delete()
            .eq('post_id', post.id);
          if (commentError) throw commentError;

          const { error: postError } = await supabaseInstance
            .from('posts')
            .delete()
            .eq('id', post.id);
          if (postError) throw postError;
          console.log("Post deleted successfully.");
        } catch (error) {
          console.error("Error deleting post:", error);
        } finally {
          setShowDeleteModal(false);
        }
      };

      const getCardColor = (type) => {
        switch (type) {
          case 'Prayer Request': return tailwindColors['prayer-color'];
          case 'Clean Up Crew': return tailwindColors['cleanup-color'];
          case 'Provisions Needed': return tailwindColors['provision-color'];
          case 'Event': return tailwindColors['event-color'];
          case 'Update': default: return tailwindColors['update-color'];
        }
      };
      
      const getEventDateColor = () => {
          return isDarkMode ? 'white' : tailwindColors['secondary-color'];
      };

      const likesCount = post.likes || 0;
      const hasLiked = post.likedBy && post.likedBy.includes(localUserId);
      const isPostOwner = post.user_id === localUserId;
      
      const renderEventDetails = () => {
          if ((post.type === 'Event' || post.type === 'Clean Up Crew') && post.event_date) {
              const formattedDate = new Date(post.event_date).toLocaleDateString();
              let detailText = post.type === 'Clean Up Crew' ? `Available Date: ${formattedDate}` : `Event Date: ${formattedDate}`;
              
              if (post.type === 'Event' && post.event_time) {
                const formattedTime = new Date(`1970-01-01T${post.event_time}`).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                detailText += ` at ${formattedTime}`;
              } else if (post.type === 'Clean Up Crew' && post.event_time) {
                const formattedTime = new Date(`1970-01-01T${post.event_time}`).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                detailText += ` (Time: ${formattedTime})`;
              }

              return e('span', { className: "ml-2 text-sm font-medium", style: { color: getEventDateColor() } }, 
                  detailText
              );
          }
          return null;
      };

      const renderPostInfo = () => {
          const date = new Date(post.timestamp);
          const formattedDate = date.toLocaleDateString();
          const formattedTime = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
          
          // Name is required for Clean Up Crew, but we check if it exists just in case
          const nameDisplay = post.name && post.name.trim() !== '' ? post.name : 'Anonymous';
          
          return `Posted by ${nameDisplay} on ${formattedDate} at ${formattedTime}`;
      };

      if (isEditing) {
        return e(EditPostForm, { post: post, setIsEditing: setIsEditing });
      }

      return e('div', {
          className: "p-4 rounded-lg shadow-md transition-all duration-300 relative",
          style: {
            backgroundColor: isDarkMode ? tailwindColors['card-bg-dark'] : tailwindColors['card-bg-light'],
            borderColor: getCardColor(post.type),
            borderWidth: '2px',
            fontSize: `${1 * fontSizeMultiplier}rem`,
          }
        },
        e('div', { className: "flex justify-between items-center mb-2" },
          e('div', { className: "flex items-center space-x-2" },
            e('span', {
              className: "text-xs font-bold rounded-full py-1 px-3",
              style: {
                backgroundColor: getCardColor(post.type),
                color: isDarkMode ? 'white' : tailwindColors['text-color'],
              }
            }, post.type),
            renderEventDetails()
          ),
          e('span', { className: "text-xs italic", style: { color: isDarkMode ? 'white' : '#555' } }, renderPostInfo())
        ),
        e('p', { style: { color: isDarkMode ? 'white' : tailwindColors['text-color'] } }, post.content),
        
        e('div', { className: "mt-4 flex items-center justify-between" },
          e('div', { className: "flex items-center space-x-4" },
            e('button', {
              onClick: handleLike,
              className: "flex items-center space-x-1 p-2 rounded-lg text-sm font-semibold transition-transform duration-200 hover:scale-105",
              style: { backgroundColor: hasLiked ? tailwindColors['primary-color'] : tailwindColors['button-bg'], color: 'white' }
            }, 
              e('svg', { xmlns: "http://www.w3.org/2000/svg", className: "h-4 w-4", viewBox: "0 0 20 20", fill: "currentColor" },
                e('path', { d: "M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z" })
              ),
              e('span', null, `Like (${likesCount})`)
            ),
            e('button', {
              onClick: () => setShowComments(!showComments),
              className: "flex items-center space-x-1 p-2 rounded-lg text-sm font-semibold transition-transform duration-200 hover:scale-105",
              style: { backgroundColor: tailwindColors['primary-color'], color: tailwindColors['text-color'] }
            }, 
              e('svg', { xmlns: "http://www.w3.org/2000/svg", className: "h-4 w-4", viewBox: "0 0 20 20", fill: "currentColor" },
                e('path', { fillRule: "evenodd", d: "M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.138C2.462 12.118 2 10.113 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7z", clipRule: "evenodd" })
              ),
              e('span', null, `Comments (${comments.length})`)
            )
          ),
          isPostOwner && e('div', { className: "flex space-x-2" },
            e('button', {
              onClick: () => setIsEditing(true),
              className: "text-xs p-1 rounded-full text-white transition-transform duration-200 hover:scale-110",
              style: { backgroundColor: tailwindColors['primary-color'] },
              title: "Edit Post"
            }, 
              e('svg', { xmlns: "http://www.w3.org/2000/svg", className: "h-4 w-4", viewBox: "0 0 20 20", fill: "currentColor" },
                e('path', { d: "M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" })
              )
            ),
            e('button', {
              onClick: () => setShowDeleteModal(true),
              className: "text-xs p-1 rounded-full text-white transition-transform duration-200 hover:scale-110",
              style: { backgroundColor: tailwindColors['secondary-color'] },
              title: "Delete Post"
            }, 
              e('svg', { xmlns: "http://www.w3.org/2000/svg", className: "h-4 w-4", viewBox: "0 0 20 20", fill: "currentColor" },
                e('path', { fillRule: "evenodd", d: "M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 011 1v6a1 1 0 11-2 0V9a1 1 0 011-1z", clipRule: "evenodd" })
              )
            )
          )
        ),
        
        showComments && e('div', { className: "mt-4 border-t pt-4", style: { borderColor: isDarkMode ? 'rgba(255,255,255,0.2)' : 'rgba(0,0,0,0.1)' } },
          e('div', { className: "mt-4 space-y-2" },
            comments.length > 0 ? (
              comments.map(comment => e('div', { key: comment.id, className: "p-3 rounded-lg", style: { backgroundColor: isDarkMode ? '#4a4a4a' : 'rgba(0,0,0,0.05)' } },
                e('p', { className: "text-sm font-semibold", style: { color: isDarkMode ? 'white' : '#555' } }, `${comment.name || 'Anonymous'}:`),
                e('p', { className: "text-sm", style: { color: isDarkMode ? '#e0e0e0' : tailwindColors['text-color'] } }, comment.content)
              ))
            ) : (
              e('p', { className: "text-center italic text-sm text-gray-500" }, "No comments yet. Be the first!")
            )
          ),
          e('div', { className: "mt-4" },
            !showCommentForm && e('button', {
              onClick: () => setShowCommentForm(true),
              className: "w-full p-2 rounded-lg font-semibold transition-transform duration-200 hover:scale-105",
              style: { backgroundColor: tailwindColors['button-bg'], color: 'white' }
            }, "Post Comment"),
            showCommentForm && e(CommentForm, { postId: post.id, isAuthReady: isAuthReady, onCancel: () => setShowCommentForm(false) })
          )
        ),

        showDeleteModal && e(ConfirmDeleteModal, {
          onConfirm: handleDelete,
          onCancel: () => setShowDeleteModal(false),
        })
      );
    }
    
    // --- Main App Component (Converted from JSX) ---
    function App() {
      const [posts, setPosts] = useState([]);
      const [isModalOpen, setIsModalOpen] = useState(false);
      const [isAuthReady, setIsAuthReady] = useState(false);
      const [localUserId, setLocalUserId] = useState(null);
      const [isMenuOpen, setIsMenuOpen] = useState(false);

      const [fontSizeMultiplier, setFontSizeMultiplier] = useState(() => {
        const savedFontSize = localStorage.getItem('fontSizeMultiplier');
        return savedFontSize ? parseFloat(savedFontSize) : 1;
      });

      const [isDarkMode, setIsDarkMode] = useState(() => {
        const savedDarkMode = localStorage.getItem('isDarkMode');
        return savedDarkMode === 'true';
      });

      // Handle Supabase initialization and authentication
      useEffect(() => {
        if (!isSupabaseConfigValid) {
            console.error("Supabase credentials are not configured. Please update the placeholders.");
            return;
        }

        let id = localStorage.getItem('local_user_id');
        if (!id) {
            id = crypto.randomUUID();
            localStorage.setItem('local_user_id', id);
        }
        setLocalUserId(id);
        
        const { data: authListener } = supabaseInstance.auth.onAuthStateChange((event, session) => {
          setIsAuthReady(true);
        });
        
        return () => {
          if (authListener) {
            authListener.subscription.unsubscribe();
          }
        };
      }, []);

      // Set up the real-time listener for posts
      useEffect(() => {
        if (isAuthReady && isSupabaseConfigValid) {
          const fetchPosts = async () => {
            try {
              // IMPORTANT: Fetch all posts, sorted by the default timestamp descending (newest post overall first)
              const { data, error } = await supabaseInstance
                .from('posts')
                .select('*')
                .order('timestamp', { ascending: false });
              if (error) throw error;
              setPosts(data);
            } catch (error) {
              // NOTE: This catches the 'Invalid API key' error if it's still happening.
              console.error("Error fetching posts:", error);
            }
          };

          const channel = supabaseInstance.channel('posts-channel')
            .on('postgres_changes', { event: '*', schema: 'public', table: 'posts' }, payload => {
              fetchPosts();
            })
            .subscribe();

          fetchPosts();

          return () => {
            supabaseInstance.removeChannel(channel);
          };
        }
      }, [isAuthReady, isSupabaseConfigValid]);

      useEffect(() => {
        localStorage.setItem('isDarkMode', isDarkMode);
      }, [isDarkMode]);

      useEffect(() => {
        localStorage.setItem('fontSizeMultiplier', fontSizeMultiplier);
      }, [fontSizeMultiplier]);

      const toggleDarkMode = () => {
        setIsDarkMode(!isDarkMode);
      };

      const increaseFontSize = () => {
        setFontSizeMultiplier(prev => Math.min(prev + 0.1, 1.5));
      };

      const decreaseFontSize = () => {
        setFontSizeMultiplier(prev => Math.max(prev - 0.1, 0.7));
      };

      const scrollToSection = (id) => {
        const element = document.getElementById(id);
        if (element) {
          element.scrollIntoView({ behavior: 'smooth' });
          setIsMenuOpen(false);
        }
      };
      
      const toggleMenu = () => {
          setIsMenuOpen(!isMenuOpen);
      };

      if (!isSupabaseConfigValid) {
          return e('div', { className: "min-h-screen flex items-center justify-center p-4 text-center bg-gray-100" },
              e('div', { className: "bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg max-w-md" },
                  e('strong', { className: "font-bold" }, "Configuration Error!"),
                  e('span', { className: "block sm:inline mt-2" }, "Please replace the placeholder values 'YOUR_SUPABASE_URL' and 'YOUR_SUPABASE_ANON_KEY' in the code with your actual Supabase project credentials.")
              )
          );
      }

      // Filter and separate posts.
      // Other categories remain sorted by post creation time (descending: newest post overall first).
      const prayerRequests = posts.filter(p => p.type === 'Prayer Request');
      const provisionsNeeded = posts.filter(p => p.type === 'Provisions Needed');
      const updates = posts.filter(p => p.type === 'Update');

      // Common reference point for date comparison (start of today)
      const now = new Date();
      now.setHours(0, 0, 0, 0); 

      // --- LOGIC 1: Sort Events Chronologically by Event Date ---
      const allEvents = posts.filter(p => p.type === 'Event' && p.event_date); 
      const futureEvents = allEvents.filter(p => new Date(p.event_date) >= now);
      const pastEvents = allEvents.filter(p => new Date(p.event_date) < now);

      // Sort future events chronologically (ascending date: nearest event first)
      futureEvents.sort((a, b) => new Date(a.event_date) - new Date(b.event_date));

      // Sort past events in reverse chronological order (newest past date first)
      pastEvents.sort((a, b) => new Date(b.event_date) - new Date(a.event_date));

      // Combine them: Future Events, followed by Past Events
      const sortedEvents = [...futureEvents, ...pastEvents];
      // -----------------------------------------------------------
      
      // --- LOGIC 2: Sort Clean Up Crew Chronologically by Available Date ---
      const allCleanup = posts.filter(p => p.type === 'Clean Up Crew' && p.event_date);

      const futureCleanup = allCleanup.filter(p => new Date(p.event_date) >= now);
      const pastCleanup = allCleanup.filter(p => new Date(p.event_date) < now);

      // Sort future cleanup chronologically (ascending date: nearest available date first)
      futureCleanup.sort((a, b) => new Date(a.event_date) - new Date(b.event_date));

      // Sort past cleanup in reverse chronological order (newest past date first)
      pastCleanup.sort((a, b) => new Date(b.event_date) - new Date(a.event_date));

      // Combine them: Future Cleanup, followed by Past Cleanup
      const sortedCleanup = [...futureCleanup, ...pastCleanup];
      // ----------------------------------------------------------------------


      // UPDATED: Menu items reflect content order (Clean Up Crew is last).
      const menuItems = [
          { id: 'updates-section', text: 'Updates' },
          { id: 'events-section', text: 'Events' },
          { id: 'prayer-requests-section', text: 'Prayer Requests' },
          { id: 'provisions-needed-section', text: 'Provisions' },
          { id: 'cleanup-section', text: 'Clean Up Crew' }, 
      ];
      
      const linkItems = [
          { href: 'MeetingSummaries.html', text: 'Meeting Summaries' },
          { href: 'Members.html', text: 'Members' },
      ];

      return e(ThemeContext.Provider, { value: { isDarkMode, toggleDarkMode } },
          e(FontSizeContext.Provider, { value: { fontSizeMultiplier, increaseFontSize, decreaseFontSize } },
              e('div', {
                  className: `min-h-screen ${isDarkMode ? 'dark bg-[#2b2b2b] text-white' : 'bg-[#f5f2ed] text-[#2b2b2b]'}`
              },
                // Header Row 1: Logo, Church Name, and Accessibility Buttons
                e('div', { className: "flex flex-col md:flex-row justify-between items-center p-4 md:p-6 shadow-md", style: { backgroundColor: tailwindColors['bg-color'] } },
                  e('div', { className: "flex items-center space-x-4 mb-4 md:mb-0" },
                    e('a', { href: "https://www.firstlovechurch.org/", target: "_blank", rel: "noopener noreferrer" },
                      e('img', {
                        src: "https://raw.githubusercontent.com/Aram814/First_Love_Church/refs/heads/main/first-love-logo-2017.png",
                        alt: "First Love Church Logo",
                        className: "h-16 w-16 rounded-full transition-transform duration-200 hover:scale-105"
                      })
                    ),
                    e('h1', { className: "text-2xl md:text-3xl font-bold", style: { color: tailwindColors['text-color'] } }, "First Love Church")
                  ),
                  e('div', { className: "flex space-x-2" },
                    e('button', {
                      onClick: increaseFontSize,
                      className: "p-2 rounded-lg text-sm font-semibold transition-transform duration-200 hover:scale-105",
                      style: { backgroundColor: tailwindColors['primary-color'], color: tailwindColors['text-color'] }
                    }, "A+"),
                    e('button', {
                      onClick: decreaseFontSize,
                      className: "p-2 rounded-lg text-sm font-semibold transition-transform duration-200 hover:scale-105",
                      style: { backgroundColor: tailwindColors['primary-color'], color: tailwindColors['text-color'] }
                    }, "A-"),
                    e('button', {
                      onClick: toggleDarkMode,
                      className: "p-2 rounded-lg text-sm font-semibold transition-transform duration-200 hover:scale-105",
                      style: { backgroundColor: tailwindColors['primary-color'], color: tailwindColors['text-color'] }
                    }, isDarkMode ? 'Light Mode' : 'Dark Mode')
                  )
                ),

                // Header Row 2: Bulletin Title and Navigation Button
                e('div', { className: "relative w-full flex justify-between items-center p-4 md:px-12 md:py-4 shadow-sm", style: { backgroundColor: tailwindColors['primary-color'] } },
                  e('h2', { className: "text-xl font-bold", style: { color: tailwindColors['text-color'] } }, "Women's Fellowship Bulletin"),
                  e('div', { className: "relative" },
                    e('button', {
                      onClick: toggleMenu,
                      className: "p-2 rounded-lg text-sm font-semibold transition-transform duration-200 hover:scale-105 flex items-center",
                      style: { backgroundColor: tailwindColors['button-bg'], color: 'white' }
                    }, 
                      "MENU",
                      e('svg', { xmlns: "http://www.w3.org/2000/svg", className: `h-4 w-4 ml-2 transition-transform duration-200 ${isMenuOpen ? 'rotate-180' : ''}`, viewBox: "0 0 20 20", fill: "currentColor" },
                        e('path', { fillRule: "evenodd", d: "M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z", clipRule: "evenodd" })
                      )
                    ),
                    isMenuOpen && e('div', { className: "absolute right-0 mt-2 w-48 rounded-lg shadow-lg py-1 z-10 flex flex-col items-end space-y-2 p-4", style: { backgroundColor: isDarkMode ? tailwindColors['card-bg-dark'] : tailwindColors['card-bg-light'], color: isDarkMode ? 'white' : tailwindColors['text-color'] } },
                      menuItems.map(item => e('button', { key: item.id, onClick: () => scrollToSection(item.id), className: "hover:underline transition-transform duration-200 hover:scale-105" }, item.text)),
                      linkItems.map(item => e('a', { key: item.href, href: item.href, className: "hover:underline transition-transform duration-200 hover:scale-105" }, item.text))
                    )
                  )
                ),

                // Post an Update Button - Centered below the headers
                e('div', { className: "flex justify-center p-4" },
                  e('button', {
                    onClick: () => setIsModalOpen(true),
                    className: "p-2 md:p-3 rounded-lg text-sm md:text-base font-semibold transition-transform duration-200 hover:scale-105",
                    style: { backgroundColor: tailwindColors['button-bg'], color: 'white' }
                  }, "Add a Post")
                ),

                // Main Content Area - Posts Feed
                e('main', { className: "p-4 md:p-6 max-w-4xl mx-auto flex flex-col gap-8" },
                  e('div', { className: "col-span-1" },
                    e('h2', { id: "updates-section", className: "text-xl font-semibold mb-4 text-center" }, "Updates"),
                    e('div', { className: "space-y-4" },
                      updates.length > 0 ? (
                        updates.map(post => e(PostCard, { key: post.id, post: post, localUserId: localUserId, isAuthReady: isAuthReady }))
                      ) : (
                        e('div', { className: "text-center text-gray-500 italic" }, "No updates yet.")
                      )
                    )
                  ),

                  e('div', { className: "col-span-1" },
                    e('h2', { id: "events-section", className: "text-xl font-semibold mb-4 text-center" }, "Events"),
                    e('div', { className: "space-y-4" },
                      // RENDER SORTED EVENTS
                      sortedEvents.length > 0 ? (
                        sortedEvents.map(post => e(PostCard, { key: post.id, post: post, localUserId: localUserId, isAuthReady: isAuthReady }))
                      ) : (
                        e('div', { className: "text-center text-gray-500 italic" }, "No events scheduled at this time.")
                      )
                    )
                  ),

                  e('div', { className: "col-span-1" },
                    e('h2', { id: "prayer-requests-section", className: "text-xl font-semibold mb-4 text-center" }, "Prayer Requests"),
                    e('div', { className: "space-y-4" },
                      prayerRequests.length > 0 ? (
                        prayerRequests.map(post => e(PostCard, { key: post.id, post: post, localUserId: localUserId, isAuthReady: isAuthReady }))
                      ) : (
                        e('div', { className: "text-center text-gray-500 italic" }, "No prayer requests at this time.")
                      )
                    )
                  ),

                  e('div', { className: "col-span-1" },
                    e('h2', { id: "provisions-needed-section", className: "text-xl font-semibold mb-4 text-center" }, "Provisions Needed"),
                    e('div', { className: "space-y-4" },
                      provisionsNeeded.length > 0 ? (
                        provisionsNeeded.map(post => e(PostCard, { key: post.id, post: post, localUserId: localUserId, isAuthReady: isAuthReady }))
                      ) : (
                        e('div', { className: "text-center text-gray-500 italic" }, "No provisions needed at this time.")
                      )
                    )
                  ),
                  
                  e('div', { className: "col-span-1" },
                    e('h2', { id: "cleanup-section", className: "text-xl font-semibold mb-4 text-center" }, "Clean Up Crew"),
                    e('div', { className: "space-y-4" },
                      // RENDER SORTED CLEANUP POSTS
                      sortedCleanup.length > 0 ? ( 
                        sortedCleanup.map(post => e(PostCard, { key: post.id, post: post, localUserId: localUserId, isAuthReady: isAuthReady }))
                      ) : (
                        e('div', { className: "text-center text-gray-500 italic" }, "No one signed up at this time.")
                      )
                    )
                  )
                ),

                // Footer
                e('footer', { className: "w-full text-center p-4 mt-8", style: { backgroundColor: tailwindColors['footer-color'], color: 'white' } },
                  e('p', { className: "text-sm" }, "© 2025 Women's Fellowship."),
                  e('p', { className: "text-sm" }, "© 2000 First Love Church. All rights reserved.")
                ),

                // Post Submission Modal (Rendered via Portal)
                isModalOpen && e(PostModal, { setIsModalOpen: setIsModalOpen, isAuthReady: isAuthReady, localUserId: localUserId })
              )
          )
      );
    }

    ReactDOM.render(e(App, null), document.getElementById('root'));
  </script>
</body>
</html>
